# 连接MySQL

1. systemctl start mysqld.service
2. mysql -u root -p/sudo mycli -u root（命令行增强）



# 选择

- 使用`use`命令
  1. use <database name>
  2. use <table name>



#　展示信息

- 使用`show`命令
  1. show databases;
  2. show tables;
  3. show columns from <table name>
  4. show grants    用来显示授予用户的安全权限
  5. show status    用于显示广泛的服务器状态信息



# CRUD

| 功能     | 动词                          |
| -------- | ----------------------------- |
| 数据查询 | select                        |
| 数据定义 | create、drop、alter（修改）   |
| 数据操纵 | insert、update、delete        |
| 数据控制 | grant（特许）、revoke（撤销） |



## 数据查询

```sql
select [ALL|DISTINCT] <目标表达式> AS (别名1),<目标表达式> AS (别名2),... 
from <table name/view name>
[where <条件表达式>]
[group by <列名1> [having <条件表达式>]]
[order by <列名2> [ASC(升序)|DESC(降序)]]
```



- DITTINCT关键字:去重

  - 该关键字会应用于所有的列

- LIMIT子句:限制结果返回行数

  ```sql
  limit 5	//返回前五行数据
  limit 5，5	//返回从第五行开始的后五行数据
  ```



### 排序检索数据

- 使用`order by <排序列名>[ASC|DESC],...`子句
- 可以指定多个列进行排序，执行顺序是先按第一个列排序，第一个列相同再按第二个列，以此类推
- 每个列可以指定`升序(ASC)`或`降序(DESC)`



### 过滤数据

- 使用`where <条件表达式>`子句

- `IS NULL`是一个判断是否为空的where子句

  | 操作符      | 说明             |
  | ----------- | ---------------- |
  | =           | 等于             |
  | !=          | 不等于           |
  | <>          | 不等于           |
  | >           | 大于             |
  | >=          | 大于等于         |
  | <           | 小于             |
  | <=          | 小于等于         |
  | between and | 在指定两个数之间 |

  



#### 数据过滤

- where子句可附加`and`、`or`、`in`、`not`操作符



​	**in的优势**

1. 对于长的选项，in的语法更清晰
2. in操作符一般比or操作符执行更快
3. in可以包含其他select语句



#### 用通配符过滤

- like操作符可以在where子句中使用
- like操作符可使用：
  - `%`:表示任何字符出现任意次
  - `_`:表示任何字符出现一次



- 通配符的处理需要花费更多的时间
- 没有必要时，不要将通配符放到搜索模式的开始处，因为这是最慢的



#### 使用MySQL正则表达式

- 在`where`子句中使用`regexp`操作符
- MySQL中的正则表达式匹配不区分大小写，为区分大小写，可使用`binary`关键字
- 正则表达式中使用`|`表示or，也可以用`[123]`集合这样的形式表达多个or，集合中`^`表示否定
- `[1-9]`、`[a-z]`表示所有的数字和字母
- MySQL中使用`\\`转义，第一个反斜杠由MySQL解释，第二个由正则表达式库解释

| 元字符 | 说明                       |
| ------ | -------------------------- |
| *      | 0个或多个匹配              |
| +      | 1个或多个匹配（等于{1,})   |
| ?      | 0个或1个匹配（等于{0,1}）  |
| {n}    | 指定数目的匹配             |
| {n,}   | 不少于指定数目的匹配       |
| {n,m}  | 匹配数目范围（m不超过255） |





##### 定位符

| 元字符  | 说明       |
| ------- | ---------- |
| ^       | 文本的开始 |
| $       | 文本的结尾 |
| [[:<:]] | 词的开始   |
| [[:>]]  | 词的结束   |



### 创建计算字段

- 计算字段：不实际存在于数据库表中，是运行时在select语句内创建的



#### 拼接字段

- 拼接：把值连接在一起构成单个值
- MySQL使用`Concat()`函数拼接
- MySQL使用`Rtrim()`函数去除串右边的空格



#### 别名

- 在select子句后用`AS`关键字赋予每个列别名



#### 算术计算

- MySQL可以对检索出的数据进行计算，输入列名的算术表达式即可



### 使用数据处理函数

#### 文本处理函数

| 函数        | 说明             |
| ----------- | ---------------- |
| Left()      | 返回串左边的字符 |
| Length()    | 返回串的长度     |
| Locate()    | 找出串的一个子串 |
| Lower()     | 将串转换为大写   |
| LTrim()     | 去除左边空格     |
| Right()     | 返回串右边的字符 |
| RTrim()     | 去除串右边的空格 |
| Soundex()   | 返回读音相近的值 |
| SubString() | 返回子串的字符   |
| Upper()     | 将串转换为大写   |



#### 日期和时间处理函数

| 函数       | 说明                   |
| ---------- | ---------------------- |
| AddDate()  | 增加一个日期           |
| AddTime()  | 增加一个时间           |
| CurDate()  | 返回当前日期           |
| CurTime()  | 返回当前时间           |
| Date()     | 返回日期时间的日期部分 |
| DateDiff() | 计算两个日期之差       |



#### 数值处理函数

| 函数   | 说明               |
| ------ | ------------------ |
| Exp()  | 返回一个数的指数值 |
| Mod()  | 返回除操作的余数   |
| Rand() | 返回一个随机数     |
| Sqrt() | 返回一个数的平方根 |



### 聚集函数

| 函数    | 说明             |
| ------- | ---------------- |
| AVG()   | 返回某列的平均值 |
| SUM()   | 返回某列的和     |
| COUNT() | 返回某列的行数   |
| MAX()   | 返回某列的最大值 |
| MIN()   | 返回某列的最小值 |



### 分组数据

- 使用`group by`子句可以对数据进行分组，并且聚集函数会对每组数据执行一次
- group by子句可以包含任意数目的列，可以对分组进行嵌套
- group by子句中不能使用别名
- 除聚集计算语句，select语句中的每个列都必须在group by子句中给出，否则会丢失数据



#### 过滤分组

- 使用`having`子句，having非常类似于where，差别在于where过滤行，having过滤分组。
